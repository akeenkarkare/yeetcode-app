echo "🔍 Running pre-commit checks..."

# Check if code is formatted with Prettier
echo "📝 Checking code formatting with Prettier..."
npm run format:check

# If format check fails, auto-format the code and continue
if [ $? -ne 0 ]; then
  echo ""
  echo "❌ Some files are not properly formatted!"
  echo "🔧 Running 'npm run format' to auto-format all files..."
  npm run format
  
  if [ $? -ne 0 ]; then
    echo ""
    echo "❌ Auto-formatting failed. Please check your code and try again."
    echo "💡 You may need to fix formatting issues manually."
    exit 1
  else
    echo ""
    echo "✅ Files have been auto-formatted with Prettier."
    echo "📋 Auto-staging formatted files..."
    git add .
    echo "🚀 Commit proceeding with formatted code..."
  fi
fi

echo ""
echo "✅ All pre-commit checks passed!"

